{
  "id": "42-trapping-rain-water",
  "title": "Trapping Rain Water",
  "difficulty": "Hard",
  "acceptance": 0.45,
  "tags": [
    "array",
    "two-pointers"
  ],
  "constraints": [
    "n == height.length",
    "0 <= n <= 2 * 10^4",
    "0 <= height[i] <= 10^5"
  ],
  "description": "Cho một mảng số nguyên height, hãy tính tổng lượng nước có thể tích trữ được giữa các cột.",
  "defaultCode": {
    "cpp": "class Solution {\npublic:\n    int trap(vector<int>& height) {\n        \n    }\n};",
    "java": "class Solution {\n    public int trap(int[] height) {\n        \n    }\n}",
    "python": "class Solution:\n    def trap(self, height: List[int]) -> int:\n        ",
    "javascript": "/**\n * @param {number[]} height\n * @return {number}\n */\nvar trap = function(height) {\n    \n};"
  },
  "driverCodes": {
    "cpp": "#include <iostream>\n#include <vector>\nusing namespace std;\n\n// __USER_CODE_HERE__\n\nint main() {\n    int n;\n    cin >> n;\n    vector<int> height(n);\n    for (int i = 0; i < n; i++) cin >> height[i];\n    Solution sol;\n    cout << sol.trap(height);\n    return 0;\n}",
    "python": "import sys\nfrom typing import List\n\n# __USER_CODE_HERE__\n\nif __name__ == \"__main__\":\n    input_data = sys.stdin.read().splitlines()\n    if len(input_data) < 1: sys.exit(0)\n    height = list(map(int, input_data[0].split()))\n    sol = Solution()\n    print(sol.trap(height))",
    "java": "import java.util.*;\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        if (!sc.hasNextLine()) return;\n        String[] parts = sc.nextLine().split(\"\\\\s+\");\n        int[] height = new int[parts.length];\n        for (int i = 0; i < parts.length; i++) height[i] = Integer.parseInt(parts[i]);\n        \n        Solution sol = new Solution();\n        System.out.print(sol.trap(height));\n    }\n}\n\n// __USER_CODE_HERE__",
    "javascript": "const fs = require('fs');\n\n// Định nghĩa một class rỗng để tránh lỗi ReferenceError nếu người dùng không dùng class\nconst Solution = {};\n\n// __USER_CODE_HERE__\n\ntry {\n    const input = fs.readFileSync(0, 'utf8').split('\\n');\n    if (input.length < 1) process.exit(0);\n\n    const height = input[0].trim().split(/\\s+/).map(Number);\n\n    const sol = new Solution();\n    // Kiểm tra xem hàm trap nằm ở global (var/function) hay nằm trong class Solution\n    const fn = (typeof trap === 'function') ? trap : (sol.trap ? sol.trap.bind(sol) : null);\n\n    if (typeof fn === 'function') {\n        const res = fn(height);\n        process.stdout.write(res.toString());\n    } else {\n        console.error(\"Error: function trap not found.\");\n    }\n} catch (e) {\n    console.error(e);\n}"
  },
  "testCases": [
    {
      "input": "0 1 0 2 1 0 1 3 2 1 2 1",
      "expected": "6",
      "isHidden": false
    },
    {
      "input": "4 2 0 3 2 5",
      "expected": "9",
      "isHidden": false
    },
    {
      "input": "0 1 0 2 1 0 1 3 2 1 2 1",
      "expected": "6",
      "isHidden": true
    }
  ],
  "examples": [
    {
      "input": "height = [0,1,0,2,1,0,1,3,2,1,2,1]",
      "output": "6",
      "explanation": "Nước có thể tích trữ được ở các vị trí như sau: \n- Vị trí 0: không tích trữ được nước\n- Vị trí 1: tích trữ được 1 đơn vị nước\n- Vị trí 2: không tích trữ được nước\n- Vị trí 3: tích trữ được 3 đơn vị nước\n- Vị trí 4: tích trữ được 2 đơn vị nước\n- Vị trí 5: tích trữ được 1 đơn vị nước\n- Vị trí 6: tích trữ được 1 đơn vị nước\n- Vị trí 7: không tích trữ được nước\n- Vị trí 8: tích trữ được 1 đơn vị nước\n- Vị trí 9: tích trữ được 1 đơn vị nước\n- Vị trí 10: tích trữ được 1 đơn vị nước\n- Vị trí 11: tích trữ được 1 đơn vị nước\nTổng lượng nước tích trữ được là 6."
    },
    {
      "input": "height = [4,2,0,3,2,5]",
      "output": "9",
      "explanation": "Nước có thể tích trữ được ở các vị trí như sau: \n- Vị trí 0: không tích trữ được nước\n- Vị trí 1: tích trữ được 3 đơn vị nước\n- Vị trí 2: tích trữ được 3 đơn vị nước\n- Vị trí 3: tích trữ được 2 đơn vị nước\n- Vị trí 4: tích trữ được 1 đơn vị nước\n- Vị trí 5: không tích trữ được nước\nTổng lượng nước tích trữ được là 9."
    }
  ],
  "editorial": {
    "approaches": [
      {
        "name": "Two Pointers (Hai con trỏ)",
        "description": "Sử dụng hai con trỏ, một ở đầu và một ở cuối mảng, di chuyển dần về giữa. Ở mỗi bước, chọn con trỏ có giá trị nhỏ hơn và di chuyển nó về phía giữa. Nếu giá trị tại vị trí con trỏ nhỏ hơn giá trị tại vị trí con trỏ kia, thì tích trữ được nước tại vị trí này.",
        "timeComplexity": "$O(n)$ - Duyệt qua mảng một lần.",
        "spaceComplexity": "$O(1)$ - Sử dụng không gian không đổi.",
        "code": {
          "cpp": "class Solution {\npublic:\n    int trap(vector<int>& height) {\n        int left = 0, right = height.size() - 1;\n        int maxLeft = 0, maxRight = 0;\n        int res = 0;\n        while (left <= right) {\n            if (height[left] < height[right]) {\n                if (height[left] >= maxLeft) {\n                    maxLeft = height[left];\n                } else {\n                    res += maxLeft - height[left];\n                }\n                left++;\n            } else {\n                if (height[right] >= maxRight) {\n                    maxRight = height[right];\n                } else {\n                    res += maxRight - height[right];\n                }\n                right--;\n            }\n        }\n        return res;\n    }\n};",
          "python": "class Solution:\n    def trap(self, height: List[int]) -> int:\n        left, right = 0, len(height) - 1\n        max_left, max_right = 0, 0\n        res = 0\n        while left <= right:\n            if height[left] < height[right]:\n                if height[left] >= max_left:\n                    max_left = height[left]\n                else:\n                    res += max_left - height[left]\n                left += 1\n            else:\n                if height[right] >= max_right:\n                    max_right = height[right]\n                else:\n                    res += max_right - height[right]\n                right -= 1\n        return res",
          "javascript": "/**\n * @param {number[]} height\n * @return {number}\n */\nvar trap = function(height) {\n    let left = 0, right = height.length - 1;\n    let maxLeft = 0, maxRight = 0;\n    let res = 0;\n    while (left <= right) {\n        if (height[left] < height[right]) {\n            if (height[left] >= maxLeft) {\n                maxLeft = height[left];\n            } else {\n                res += maxLeft - height[left];\n            }\n            left++;\n        } else {\n            if (height[right] >= maxRight) {\n                maxRight = height[right];\n            } else {\n                res += maxRight - height[right];\n            }\n            right--;\n        }\n    }\n    return res;\n};",
          "java": "class Solution {\n    public int trap(int[] height) {\n        int left = 0, right = height.length - 1;\n        int maxLeft = 0, maxRight = 0;\n        int res = 0;\n        while (left <= right) {\n            if (height[left] < height[right]) {\n                if (height[left] >= maxLeft) {\n                    maxLeft = height[left];\n                } else {\n                    res += maxLeft - height[left];\n                }\n                left++;\n            } else {\n                if (height[right] >= maxRight) {\n                    maxRight = height[right];\n                } else {\n                    res += maxRight - height[right];\n                }\n                right--;\n            }\n        }\n        return res;\n    }\n}"
        }
      }
    ],
    "videoUrl": "https://youtube.com/watch?v=ZI2z5pq0TqA",
    "content": "Bài toán này có thể được giải quyết bằng cách sử dụng hai con trỏ, một ở đầu và một ở cuối mảng, di chuyển dần về giữa. Ở mỗi bước, chọn con trỏ có giá trị nhỏ hơn và di chuyển nó về phía giữa. Nếu giá trị tại vị trí con trỏ nhỏ hơn giá trị tại vị trí con trỏ kia, thì tích trữ được nước tại vị trí này."
  }
}